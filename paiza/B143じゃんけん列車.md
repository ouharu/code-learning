# B143:じゃんけん列車

```python
def find_winners(N, M, matches):
    # 初始化每个园児为独立的列车
    trains = [[i] for i in range(1, N+1)]

    # 处理每次じゃんけん的结果
    for winner, loser in matches:
        # 找到获胜和失败园児所在的列车
        winner_train = next(train for train in trains if train[0] == winner)
        loser_train = next(train for train in trains if train[0] == loser)

        # 将失败的列车连接到获胜的列车末尾
        winner_train.extend(loser_train)
        trains.remove(loser_train)

    # 找到最长的列车
    max_length = max(len(train) for train in trains)
    winners = [train[0] for train in trains if len(train) == max_length]

    return winners

# 读取输入
N, M = map(int, input().split())
matches = [tuple(map(int, input().split())) for _ in range(M)]

# 找到优胜者
winners = find_winners(N, M, matches)

# 输出结果
for winner in winners:
    print(winner)
```

```python
N, M = map(int, input().split())
winners = {}
for _ in range(M):
    x, y = map(int, input().split())
    if x not in winners:
        winners[x] = []
    if y not in winners:
        winners[y] = []
    winners[x].append(y)

max_length = 0
winning_train = []
for key, value in winners.items():
    length = len(value) + 1
    if length > max_length:
        max_length = length
        winning_train = [key]
    elif length == max_length:
        winning_train.append(key)

print(*sorted(winning_train))
```

